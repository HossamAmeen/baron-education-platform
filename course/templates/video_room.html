<html>
<head>
    <style>
        #root {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="root"></div>
</body>
<script src="https://unpkg.com/@zegocloud/zego-uikit-prebuilt/zego-uikit-prebuilt.js"></script>
<script>
window.onload = function () {
    function getUrlParams(url) {
        let urlStr = url.split('?')[1];
        const urlSearchParams = new URLSearchParams(urlStr);
        return Object.fromEntries(urlSearchParams.entries());
    }

    const params = getUrlParams(window.location.href);
    const roomID = params['roomID'];
    const userID = Math.floor(Math.random() * 10000) + "";
    const userName = params['userName'] || ("user" + userID);
    const appID = 1524590697;
    const serverSecret = "b3ef31a39250abbb3505944cef072471";
    const kitToken = ZegoUIKitPrebuilt.generateKitTokenForTest(appID, serverSecret, roomID, userID, userName);

    let role = params['role'] || 'Host';
    role = role === 'Host' ? ZegoUIKitPrebuilt.Host : ZegoUIKitPrebuilt.Audience;

    let config = {}
    if (role === ZegoUIKitPrebuilt.Host) {
        config = {
            turnOnCameraWhenJoining: true,
            showMyCameraToggleButton: true,
            showAudioVideoSettingsButton: true,
            showScreenSharingButton: true,
            showTextChat: true,
            showUserList: true,
        }
    }

    const zp = ZegoUIKitPrebuilt.create(kitToken);
    zp.joinRoom({
        container: document.querySelector("#root"),
        scenario: {
            mode: ZegoUIKitPrebuilt.LiveStreaming,
            config: { role },
        },
        sharedLinks: [{
            name: 'Join as an audience',
            url: window.location.protocol + '//' +
                 window.location.host +
                 window.location.pathname +
                 '?roomID=' + roomID +
                 '&role=Audience',
        }],
        ...config
    });
}
</script>
</html>
